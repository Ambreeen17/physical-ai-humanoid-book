# ROS 2 Humble + Gazebo Harmonic Lab Environment
# Chapter 2: Kinematics & Dynamics Labs
# Target: Ubuntu 22.04 + ROS 2 Humble + Gazebo Harmonic
# Build: docker build -f Dockerfile.lab -t ros2-lab-ch2 .
# Run:  docker run -it ros2-lab-ch2

FROM osrf/ros:humble-desktop-full-jammy

# Install additional dependencies for kinematics & dynamics
RUN apt-get update && apt-get install -y \
    python3-numpy \
    python3-scipy \
    python3-matplotlib \
    python3-pytest \
    python3-rospkg \
    libeigen3-dev \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# Install Python dependencies for IK/Dynamics calculations
RUN pip3 install --no-cache-dir \
    numpy==1.24.3 \
    scipy==1.10.1 \
    sympy==1.12 \
    matplotlib==3.7.2

# Set working directory
WORKDIR /root/ros2_ws

# Source ROS 2
RUN echo "source /opt/ros/humble/setup.bash" >> /root/.bashrc

# Set environment variables for Gazebo
ENV GAZEBO_MODEL_PATH=/root/ros2_ws/src:${GAZEBO_MODEL_PATH}
ENV GAZEBO_RESOURCE_PATH=/root/ros2_ws/src:${GAZEBO_RESOURCE_PATH}

# Default command
CMD ["bash"]
